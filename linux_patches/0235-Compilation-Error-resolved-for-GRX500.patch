From 27625ecfc41236dde867a691973a47d2b0faa27f Mon Sep 17 00:00:00 2001
From: thampan <joby.thampan@intel.com>
Date: Mon, 3 Sep 2018 15:32:53 +0800
Subject: [PATCH] Compilation Error resolved for GRX500

---
 drivers/net/ethernet/lantiq/datapath/datapath_api.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/lantiq/datapath/datapath_api.c b/drivers/net/ethernet/lantiq/datapath/datapath_api.c
index e4e27e323c06..0ce8fa21f935 100644
--- a/drivers/net/ethernet/lantiq/datapath/datapath_api.c
+++ b/drivers/net/ethernet/lantiq/datapath/datapath_api.c
@@ -1933,9 +1933,14 @@ static inline int32_t dp_rx_one_skb(struct sk_buff *skb, uint32_t flags)
 	}
 #endif
 	/*PON traffic always have timestamp attached,removing Timestamp */
-	if (dp_port->alloc_flags & (DP_F_GPON | DP_F_EPON) && !dp_port->f_ptp) {
+	if (dp_port->alloc_flags & (DP_F_GPON | DP_F_EPON)) {
 		/* Stripping of last 10 bytes timestamp */
+#if IS_ENABLED(CONFIG_LTQ_DATAPATH_PTP1588)
+		if (!dp_port->f_ptp)
+			__pskb_trim(skb, skb->len - DP_TS_HDRLEN);
+#else
 		__pskb_trim(skb, skb->len - DP_TS_HDRLEN);
+#endif
 	}
 
 	rx_fn = dp_port->cb.rx_fn;
