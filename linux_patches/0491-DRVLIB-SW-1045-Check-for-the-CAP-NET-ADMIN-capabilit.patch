From 42a461d6180cad7a78d0b45aff2cc721b3919b5f Mon Sep 17 00:00:00 2001
From: Dinesh Sudham <dineshx.sudham@intel.com>
Date: Fri, 1 Mar 2019 16:08:51 +0800
Subject: [PATCH] DRVLIB_SW-1045:Check for the CAP_NET_ADMIN capability

---
 drivers/net/ethernet/lantiq/switch-api/gsw_ioctl_wrapper.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/drivers/net/ethernet/lantiq/switch-api/gsw_ioctl_wrapper.c b/drivers/net/ethernet/lantiq/switch-api/gsw_ioctl_wrapper.c
index 591a3bc8beb0..b04f5140a3b2 100644
--- a/drivers/net/ethernet/lantiq/switch-api/gsw_ioctl_wrapper.c
+++ b/drivers/net/ethernet/lantiq/switch-api/gsw_ioctl_wrapper.c
@@ -180,6 +180,9 @@ static long gsw_api_ioctl(struct file *filp, u32 cmd, unsigned long arg)
 	ioctl_wrapper_ctx_t *pdev;
 	ioctl_cmd_handle_t *cmd_handle;
 
+	if (!capable(CAP_NET_ADMIN))
+		return -EPERM;
+
 	if (!ioctlwrapctx) {
 		pr_err("ioctlwrapctx not initilized\n");
 		return -1;
