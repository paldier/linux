From e020591b8ec8b696c5a3113fe0351780f9daa4b0 Mon Sep 17 00:00:00 2001
From: moinakde <moinak.debnath@intel.com>
Date: Fri, 10 May 2019 15:10:22 +0530
Subject: [PATCH] UGW_SW-38655: PPA IPv6 acceleration fix

---
 drivers/net/ethernet/lantiq/ppa/ppa_hook.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/lantiq/ppa/ppa_hook.c b/drivers/net/ethernet/lantiq/ppa/ppa_hook.c
index 03a7e6d18a53..048de337bc94 100644
--- a/drivers/net/ethernet/lantiq/ppa/ppa_hook.c
+++ b/drivers/net/ethernet/lantiq/ppa/ppa_hook.c
@@ -722,13 +722,13 @@ static unsigned int ppa_postrt_hook_fn(void *priv,
 	packet which will eventually take the IPSec Path */
 #if IS_ENABLED(CONFIG_PPA_MPE_IP97)
 	struct iphdr *hdr = ip_hdr(skb);
-	if (hdr->protocol == IPPROTO_ESP || skb_dst(skb)->flags & (DST_XFRM_TUNNEL | DST_HOST) || !ppa_hook_session_add_fn)
+	if (hdr->protocol == IPPROTO_ESP || skb_dst(skb)->flags & DST_XFRM_TUNNEL || !ppa_hook_session_add_fn)
 		return NF_ACCEPT;
 	/* In the Second call (After Encryption) we skip again for
 	ESP type since we call this hook in xfrm_output_resume before
 	old conntrack reset, based on which the p_item was created */
 #else
-	if (skb_dst(skb)->flags & (DST_XFRM_TUNNEL | DST_HOST) || !ppa_hook_session_add_fn)
+	if (skb_dst(skb)->flags & DST_XFRM_TUNNEL || !ppa_hook_session_add_fn)
 		return NF_ACCEPT;
 #endif
 
