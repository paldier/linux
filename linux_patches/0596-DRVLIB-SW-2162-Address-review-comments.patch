From 87b2d11a2611926086a221984e271297b5edd104 Mon Sep 17 00:00:00 2001
From: Rekha Eswaran <rekha.eswaran@intel.com>
Date: Mon, 13 May 2019 17:30:40 +0800
Subject: [PATCH] DRVLIB_SW-2162 - Address review comments

---
 drivers/net/datapath/dpm/datapath.h              | 3 ---
 drivers/net/datapath/dpm/datapath_api.c          | 4 ++++
 drivers/net/datapath/dpm/gswip30/datapath_proc.c | 1 -
 drivers/net/datapath/dpm/gswip31/datapath_misc.c | 2 +-
 drivers/net/ethernet/lantiq/tmu/drv_tmu_ll.c     | 2 +-
 include/net/datapath_api.h                       | 3 +++
 6 files changed, 9 insertions(+), 6 deletions(-)

diff --git a/drivers/net/datapath/dpm/datapath.h b/drivers/net/datapath/dpm/datapath.h
index 9442eeb4dd7e..ba6878a0c240 100644
--- a/drivers/net/datapath/dpm/datapath.h
+++ b/drivers/net/datapath/dpm/datapath.h
@@ -863,10 +863,7 @@ char *dp_skb_csum_str(struct sk_buff *skb);
 extern struct dentry *dp_proc_node;
 int get_dp_dbg_flag_str_size(void);
 int get_dp_port_status_str_size(void);
-int get_dp_port_type_str_size(void);
-char *get_dp_port_type_str(int k);
 
-u32 *get_port_flag(int inst, int index);
 int dp_request_inst(struct dp_inst_info *info, u32 flag);
 int register_dp_cap(u32 flag);
 typedef GSW_return_t(*dp_gsw_cb)(void *, void *);
diff --git a/drivers/net/datapath/dpm/datapath_api.c b/drivers/net/datapath/dpm/datapath_api.c
index ea0bb8dc21bb..f4c279c86a36 100644
--- a/drivers/net/datapath/dpm/datapath_api.c
+++ b/drivers/net/datapath/dpm/datapath_api.c
@@ -113,16 +113,19 @@ char *get_dp_port_type_str(int k)
 {
 	return dp_port_type_str[k];
 }
+EXPORT_SYMBOL(get_dp_port_type_str);
 
 u32 get_dp_port_flag(int k)
 {
 	return dp_port_flag[k];
 }
+EXPORT_SYMBOL(get_dp_port_flag);
 
 int get_dp_port_type_str_size(void)
 {
 	return ARRAY_SIZE(dp_port_type_str);
 }
+EXPORT_SYMBOL(get_dp_port_type_str_size);
 
 int get_dp_dbg_flag_str_size(void)
 {
@@ -196,6 +199,7 @@ u32 *get_port_flag(int inst, int index)
 
 	return NULL;
 }
+EXPORT_SYMBOL(get_port_flag);
 
 struct pmac_port_info *get_port_info_via_dp_port(int inst, int dp_port)
 {
diff --git a/drivers/net/datapath/dpm/gswip30/datapath_proc.c b/drivers/net/datapath/dpm/gswip30/datapath_proc.c
index cac2e425d70d..fbd9434f739a 100644
--- a/drivers/net/datapath/dpm/gswip30/datapath_proc.c
+++ b/drivers/net/datapath/dpm/gswip30/datapath_proc.c
@@ -12,7 +12,6 @@
 #include <net/drv_tmu_ll.h>
 #include <linux/list.h>
 #include <net/lantiq_cbm_api.h>
-#include "../../../ethernet/lantiq/cqm/grx500/reg/fsqm.h" /* hardcoded path*/
 
 #include <linux/list.h>
 
diff --git a/drivers/net/datapath/dpm/gswip31/datapath_misc.c b/drivers/net/datapath/dpm/gswip31/datapath_misc.c
index 0558db171c6f..6ed9d0f6c568 100644
--- a/drivers/net/datapath/dpm/gswip31/datapath_misc.c
+++ b/drivers/net/datapath/dpm/gswip31/datapath_misc.c
@@ -465,7 +465,7 @@ int alloc_q_to_port(struct ppv4_q_sch_port *info, u32 flag)
 	if (priv->deq_port_stat[info->cqe_deq].flag == PP_NODE_FREE) {
 		port.cqm_deq_port = info->cqe_deq;
 		port.tx_pkt_credit = info->tx_pkt_credit;
-		port.tx_ring_addr = info->tx_ring_addr_push;
+		port.tx_ring_addr = info->tx_ring_addr;
 		port.tx_ring_size = info->tx_ring_size;
 		port.inst = inst;
 		port.dp_port = info->dp_port;
diff --git a/drivers/net/ethernet/lantiq/tmu/drv_tmu_ll.c b/drivers/net/ethernet/lantiq/tmu/drv_tmu_ll.c
index bba7c8f3f792..e92437f176c1 100644
--- a/drivers/net/ethernet/lantiq/tmu/drv_tmu_ll.c
+++ b/drivers/net/ethernet/lantiq/tmu/drv_tmu_ll.c
@@ -15,7 +15,7 @@
 #include "../cqm/grx500/reg/cbm_eqm.h"
 #include "../cqm/grx500/reg/cbm_desc64b.h"
 #include "../cqm/grx500/reg/fsqm.h"
-#include "../../../datapath/dpm/datapath.h"
+#include <net/datapath_api.h>
 #include <lantiq.h>		/*clk_get_ppe */
 #include <net/datapath_proc_api.h>
 #include <linux/clk.h>
diff --git a/include/net/datapath_api.h b/include/net/datapath_api.h
index 89fc451629c7..e3b43b1c24d4 100644
--- a/include/net/datapath_api.h
+++ b/include/net/datapath_api.h
@@ -1476,6 +1476,9 @@ int dp_coc_new_stat_req(int new_state, uint32_t flag);
 
 /*! get port flag. for TMU proc file cat /proc/tmu/queue1 and /proc/tmu/eqt */
 u32 get_dp_port_flag(int k);
+char *get_dp_port_type_str(int k);
+int get_dp_port_type_str_size(void);
+u32 *get_port_flag(int inst, int index);
 
 /*! @brief set parser: to enable/disable pmac header
  *@param[in] flag flag
