From 6a2be7760b2901e95fe5d197524c351d74dceb75 Mon Sep 17 00:00:00 2001
From: gsupriya <supriya1.g@intel.com>
Date: Thu, 7 Feb 2019 22:15:39 +0530
Subject: [PATCH] UGW_SW-35199: Changing mcast_helper to loadable kernel module
 to support autoload feature

---
 net/Makefile                        |  2 +-
 net/mcast_helper/Kconfig            | 12 ++++++++++++
 net/mcast_helper/Makefile           |  2 +-
 net/mcast_helper/mcast_helper_reg.c |  2 +-
 4 files changed, 15 insertions(+), 3 deletions(-)

diff --git a/net/Makefile b/net/Makefile
index be46f0407103..f22dd8d15e50 100644
--- a/net/Makefile
+++ b/net/Makefile
@@ -18,7 +18,7 @@ obj-$(CONFIG_INET)		+= ipv4/
 obj-$(CONFIG_XFRM)		+= xfrm/
 obj-$(CONFIG_UNIX)		+= unix/
 obj-$(CONFIG_NET)		+= ipv6/
-obj-$(CONFIG_MCAST_HELPER) 	+= mcast_helper/
+obj-$(CONFIG_MCAST_HELPER_PACKAGE)	+= mcast_helper/
 obj-$(CONFIG_PACKET)		+= packet/
 obj-$(CONFIG_NET_KEY)		+= key/
 obj-$(CONFIG_BRIDGE)		+= bridge/
diff --git a/net/mcast_helper/Kconfig b/net/mcast_helper/Kconfig
index 4c03c86878dc..8c3c5a48eabe 100644
--- a/net/mcast_helper/Kconfig
+++ b/net/mcast_helper/Kconfig
@@ -2,6 +2,18 @@
 # mcast_helper configuration
 #
 
+config MCAST_HELPER_PACKAGE
+	tristate "Multicast Helper package enable"
+	default n
+	help
+	  mcast_helper support
+
+config MCAST_HELPER_REG
+	tristate "Multicast Helper Register Support"
+	default n
+	help
+	  mcast_helper reg support
+
 config MCAST_HELPER
 	tristate "Multicast Helper support"
 	default n 
diff --git a/net/mcast_helper/Makefile b/net/mcast_helper/Makefile
index 6d38bca85c5a..fb1da2c90fab 100644
--- a/net/mcast_helper/Makefile
+++ b/net/mcast_helper/Makefile
@@ -2,5 +2,5 @@
 # Makefile for the mcast_helper.
 #
 
+obj-$(CONFIG_MCAST_HELPER_REG) += mcast_helper_reg.o
 obj-$(CONFIG_MCAST_HELPER) += mcast_helper.o
-obj-$(CONFIG_MCAST_HELPER) += mcast_helper_reg.o
diff --git a/net/mcast_helper/mcast_helper_reg.c b/net/mcast_helper/mcast_helper_reg.c
index bb0cd5c394d1..81fcbdd04c0a 100644
--- a/net/mcast_helper/mcast_helper_reg.c
+++ b/net/mcast_helper/mcast_helper_reg.c
@@ -19,7 +19,7 @@
 
 
 
-#if IS_ENABLED(CONFIG_MCAST_HELPER)
+#if IS_ENABLED(CONFIG_MCAST_HELPER_REG)
 
 #include <linux/kernel.h>
 #include <linux/netdevice.h>
