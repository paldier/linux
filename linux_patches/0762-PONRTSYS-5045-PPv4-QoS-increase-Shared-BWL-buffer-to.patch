From 6624dbb992e5d0941c6acc1fbd35ffa6bd95f166 Mon Sep 17 00:00:00 2001
From: ofirbitt <ofir1.bitton@intel.com>
Date: Mon, 26 Aug 2019 13:04:09 +0300
Subject: [PATCH] PONRTSYS-5045: PPv4 QoS increase Shared BWL buffer to match
 FW

---
 drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_linux.c | 2 +-
 drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_main.c  | 2 +-
 drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_utils.h | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_linux.c b/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_linux.c
index df554e4197aa..1afb9ae0eee9 100644
--- a/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_linux.c
+++ b/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_linux.c
@@ -423,7 +423,7 @@ static int pp_qos_config_from_of_node(
 		pdata->bwl_ddr_phys,
 		pdata->bwl_ddr_virt);
 
-	pdata->sbwl_sz = PAGE_ALIGN(NUM_OF_NODES * sizeof(u8));
+	pdata->sbwl_sz = PAGE_ALIGN(NUM_OF_NODES * sizeof(u32));
 	pdata->sbwl_ddr_virt = dmam_alloc_coherent(
 			dev,
 			pdata->sbwl_sz,
diff --git a/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_main.c b/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_main.c
index f28cbca38f9a..d71074328bc5 100644
--- a/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_main.c
+++ b/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_main.c
@@ -2481,7 +2481,7 @@ struct pp_qos_dev *create_qos_dev_desc(struct qos_dev_init_info *initinfo)
 			initinfo->pl_data.bwl_ddr_phys;
 
 		qdev->hwconf.sbwl_ddr_virt =
-			(unsigned char *)initinfo->pl_data.sbwl_ddr_virt;
+			(unsigned int *)initinfo->pl_data.sbwl_ddr_virt;
 		qdev->hwconf.sbwl_ddr_phys =
 			initinfo->pl_data.sbwl_ddr_phys;
 
diff --git a/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_utils.h b/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_utils.h
index 8ce04aaa0558..be3c56f6d30d 100644
--- a/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_utils.h
+++ b/drivers/net/ethernet/lantiq/ppv4/qos/pp_qos_utils.h
@@ -227,7 +227,7 @@ struct hw_conf {
 	dma_addr_t	max_allowed_ddr_phys;
 	unsigned int	*bwl_ddr_virt;
 	dma_addr_t	bwl_ddr_phys;
-	unsigned char	*sbwl_ddr_virt;
+	unsigned int	*sbwl_ddr_virt;
 	dma_addr_t	sbwl_ddr_phys;
 };
 
