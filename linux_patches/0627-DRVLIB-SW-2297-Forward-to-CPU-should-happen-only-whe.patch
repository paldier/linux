From 1202cc5c4d9185a9476a8925b4bdb01ce37b6003 Mon Sep 17 00:00:00 2001
From: thampan <joby.thampan@intel.com>
Date: Thu, 6 Jun 2019 19:02:54 +0800
Subject: [PATCH] DRVLIB_SW-2297: Forward to CPU should happen only when
 Insertion=0

---
 drivers/net/ethernet/lantiq/switch-api/gsw_flow_core.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/drivers/net/ethernet/lantiq/switch-api/gsw_flow_core.c b/drivers/net/ethernet/lantiq/switch-api/gsw_flow_core.c
index 9e6e0741c3c5..766bb7a968cb 100644
--- a/drivers/net/ethernet/lantiq/switch-api/gsw_flow_core.c
+++ b/drivers/net/ethernet/lantiq/switch-api/gsw_flow_core.c
@@ -10958,6 +10958,12 @@ GSW_return_t GSW_MulticastSnoopCfgSet(void *cdev,
 					(1 << parm->nForwardPortId);
 				pcrule.pattern.nPortId = parm->nForwardPortId;
 			} else if (parm->eForwardPort == GSW_PORT_FORWARD_CPU) {
+
+				if (IS_VRSN_31_OR_32(gswdev->gipver)) {
+					pcrule.pattern.bInsertionFlag_Enable = 1;
+					pcrule.pattern.nInsertionFlag = 0;
+				}
+
 				pcrule.action.nForwardPortMap[0] =
 					(1 << gswdev->cport);
 				pcrule.pattern.nPortId = gswdev->cport;
