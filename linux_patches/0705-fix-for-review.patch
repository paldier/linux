From b514ef755cccd784a4a5443a5e570ce1f8c4cee6 Mon Sep 17 00:00:00 2001
From: Li Yin <yin1.li@intel.com>
Date: Tue, 23 Jul 2019 17:40:46 +0800
Subject: [PATCH] fix for review

---
 include/net/datapath_api_qos.h |  3 +--
 include/net/datapath_api_tx.h  | 35 +++++++----------------------------
 2 files changed, 8 insertions(+), 30 deletions(-)

diff --git a/include/net/datapath_api_qos.h b/include/net/datapath_api_qos.h
index 96592343a139..f9bce8a38c50 100644
--- a/include/net/datapath_api_qos.h
+++ b/include/net/datapath_api_qos.h
@@ -10,7 +10,7 @@
 /*!
  * @file Datapath_api_qos.h
  *
- *  @brief &nbsp; Datapath QOS HAL API
+ *  @brief Datapath QOS HAL API
  *<PRE>
  *  Purpose: try to provide common QOS HAL API and hide HW difference inside
  *           Datapath QOS HAL
@@ -1252,7 +1252,6 @@ int dp_ingress_ctp_tc_map_set(struct dp_tc_cfg *tc, int flag);
 struct dp_qos_cfg_info {
 	int inst; /*!< input: dp instance. For SOC side, it is always zero */
 	u32 quanta; /*!< QoS quanta for scheduler */
-	
 };
 
 /*!< API dp_qos_global_info_get: Helps to retrieve global QoS
diff --git a/include/net/datapath_api_tx.h b/include/net/datapath_api_tx.h
index f87fb0883c8a..52a525e1b512 100644
--- a/include/net/datapath_api_tx.h
+++ b/include/net/datapath_api_tx.h
@@ -5,14 +5,15 @@
 /*!
  * @file datapath_api_tx.h
  *
- * @brief &nbsp; Datapath TX path API
+ * @brief Datapath TX path API
  */
  /*! @} */
 
-#ifndef DP_TX_FN_CONTINUE
-#define DP_TX_FN_CONTINUE 1 /*!< @brief return this value in callback
-			       function to continue execution */
-#endif /* !DP_TX_FN_CONTINUE */
+enum DP_TX_FN_RET {
+	DP_TX_FN_CONSUMED,
+	DP_TX_FN_CONTINUE,
+	DP_TX_FN_DROPPED,
+};
 
 /**
  * enum DP_TX_PRIORITY - define TX chain priority from high to low
@@ -33,7 +34,6 @@ enum DP_TX_PRIORITY {
 enum DP_TX_FLAGS {
 	DP_TX_FLAG_INSERT_PMAC = BIT(0), /*!< insert PMAC header*/
 	DP_TX_FLAG_STREAM_PORT = BIT(1), /*!< is stream port*/
-	DP_TX_FLAG_SKIP_NEXT = BIT(2), /*!< skip next TX call*/
 };
 
 /**
@@ -58,7 +58,7 @@ struct dp_tx_common {
  * @param[in,out] cmn: common data which is persist across the call chain
  * @param[in,out] p: private parameter passed in from dp_register_tx()
  *
- * @Return 0 - skb consumed, stop further process;
+ * @Return DP_TX_FN_CONSUMED - skb consumed, stop further process;
  *         DP_TX_FN_CONTINUE skb - not consumed, continue for further process;
  *         others - skb not consumed with error code, stop further process
  */
@@ -72,25 +72,4 @@ typedef int (*tx_fn)(struct sk_buff *skb, struct dp_tx_common *cmn, void *p);
  */
 int dp_register_tx(enum DP_TX_PRIORITY priority, tx_fn fn, void *p);
 
-/**
- * dp_tx_skip_next_call() - set to skip next TX call
- */
-static inline void dp_tx_skip_next_call(struct dp_tx_common *cmn)
-{
-	cmn->flags |= DP_TX_FLAG_SKIP_NEXT;
-}
-
-/**
- * dp_tx_call_skipped() - check if current call should be skipped
- */
-static inline bool dp_tx_call_skipped(struct dp_tx_common *cmn)
-{
-	if (unlikely(cmn->flags & DP_TX_FLAG_SKIP_NEXT)) {
-		cmn->flags &= ~DP_TX_FLAG_SKIP_NEXT;
-		return true;
-	} else {
-		return false;
-	}
-}
-
 #endif /* end of include guard: DATAPATH_API_TX_H_34JWW7RR */
