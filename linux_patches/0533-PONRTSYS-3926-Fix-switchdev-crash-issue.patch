From da4c11dab9a6872f8cef668dd474d8d58a7d43d1 Mon Sep 17 00:00:00 2001
From: Rekha Eswaran <rekha.eswaran@intel.com>
Date: Mon, 1 Apr 2019 22:27:22 +0800
Subject: [PATCH] PONRTSYS-3926: Fix switchdev crash issue

---
 drivers/net/ethernet/lantiq/datapath/datapath_swdev.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/lantiq/datapath/datapath_swdev.c b/drivers/net/ethernet/lantiq/datapath/datapath_swdev.c
index 05c11b8e3593..237cd72da2f2 100644
--- a/drivers/net/ethernet/lantiq/datapath/datapath_swdev.c
+++ b/drivers/net/ethernet/lantiq/datapath/datapath_swdev.c
@@ -501,7 +501,8 @@ static int dp_swdev_add_if(struct net_device *dev,
 			br_item->flags = flag;
 		} else {
 			br_item->flags = ADD_BRENTRY | flag;
-			if (dp_port_info[inst][port].swdev_en == 1) {
+			if (dp_port_info[br_item->inst]
+					[br_item->dp_port].swdev_en == 1) {
 				br_id = dp_port_prop[br_item->inst].info.
 					swdev_alloc_bridge_id(br_item->inst);
 				if (br_id) {
