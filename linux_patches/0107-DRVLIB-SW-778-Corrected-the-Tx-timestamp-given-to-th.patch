From 2e557a1048e2ae4f6af34c619967ab3e8c42d9d8 Mon Sep 17 00:00:00 2001
From: thampan <joby.thampan@intel.com>
Date: Fri, 29 Jun 2018 21:16:32 +0800
Subject: [PATCH] DRVLIB_SW-778: Corrected the Tx timestamp given to the
 application for 2-Step

---
 drivers/net/ethernet/lantiq/switch-api/mac/xgmac_mac_api.c | 13 +------------
 1 file changed, 1 insertion(+), 12 deletions(-)

diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_mac_api.c b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_mac_api.c
index 6d57841056d6..348f8ba8d67f 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_mac_api.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_mac_api.c
@@ -1266,20 +1266,9 @@ u64 xgmac_get_tx_tstamp(void *pdev)
 	u32 tx_snr;
 	u64 nsec;
 
-	tx_snr = XGMAC_RGRD(pdata, MAC_TXTSTAMP_NSECR);
-
-	/* check whether tstamp of the prev pkt is overwritten with the
-	 * tstamp of the cur pkt
-	 */
-	if (MAC_GET_VAL(tx_snr, MAC_TXTSTAMP_NSECR, TXTSSTSMIS)) {
-		mac_printf("timestamp of the current pkt is ignored\n");
-		/* timesatmp of the current pkt is ignored */
-		return 0;
-	}
-
 	nsec = XGMAC_RGRD(pdata, MAC_TXTSTAMP_SECR);
 	nsec *= NSEC_TO_SEC;
-	nsec += tx_snr;
+	nsec += XGMAC_RGRD(pdata, MAC_TXTSTAMP_NSECR);
 
 	return nsec;
 }
