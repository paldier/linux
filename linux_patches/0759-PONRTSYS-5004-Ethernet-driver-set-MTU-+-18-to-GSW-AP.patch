From c6e09ab83456f543da3f16112f82717453be666a Mon Sep 17 00:00:00 2001
From: arathinx <ayyappanx.rathinam@intel.com>
Date: Tue, 20 Aug 2019 17:03:57 +0800
Subject: [PATCH] PONRTSYS-5004: Ethernet driver set MTU + 18 to GSW API call

---
 drivers/net/ethernet/lantiq/ltq_eth_drv_xrx500.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/lantiq/ltq_eth_drv_xrx500.c b/drivers/net/ethernet/lantiq/ltq_eth_drv_xrx500.c
index 7b840a115fbb..00e8a1ab59a3 100644
--- a/drivers/net/ethernet/lantiq/ltq_eth_drv_xrx500.c
+++ b/drivers/net/ethernet/lantiq/ltq_eth_drv_xrx500.c
@@ -769,8 +769,14 @@ static int ltq_change_mtu(struct net_device *dev, int new_mtu)
 			struct mac_ops *ops;
 
 			ops = gsw_get_mac_ops(0, priv->xgmac_id);
+
+			/* In OMCI daemon, need to use ifconfig to set mtu to
+			 * [L2 Maximum Frame Size - 18] ex: (1518 - 18 = 1500)
+			 * 18 bytes is the ETH header and FCS
+			 */
 			if (ops)
-				ops->set_mtu(ops, new_mtu);
+				ops->set_mtu(ops,
+					    (new_mtu + ETH_HLEN + ETH_FCS_LEN));
 		}
 	} else {
 
