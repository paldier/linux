From af49d14a3e7c0cd4331c19ae25b5c0324bfe17ed Mon Sep 17 00:00:00 2001
From: arathinx <ayyappanx.rathinam@intel.com>
Date: Fri, 2 Aug 2019 17:15:23 +0800
Subject: [PATCH] DRVLIB_SW-2559: Error handling is missing for CQM Buff
 failure

---
 drivers/net/ethernet/lantiq/cqm/prx300/cqm.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/lantiq/cqm/prx300/cqm.c b/drivers/net/ethernet/lantiq/cqm/prx300/cqm.c
index f42c2aeac29a..9b808e6b3b7d 100644
--- a/drivers/net/ethernet/lantiq/cqm/prx300/cqm.c
+++ b/drivers/net/ethernet/lantiq/cqm/prx300/cqm.c
@@ -2372,7 +2372,7 @@ static int fill_rx_ring_data(struct cbm_dp_alloc_complete_data *dp_data)
 				dmam_free_coherent(cqm_ctrl->dev, dma_size,
 						   dma_vaddr, dma_paddr);
 				ltq_free_dma(p_info->dma_ch);
-				break;
+				return CBM_FAILURE;
 			}
 			p_info->deq_info.pkt_base[idx] =
 					__pa(buf - CQM_POOL_METADATA);
