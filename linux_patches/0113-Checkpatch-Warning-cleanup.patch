From bbb56fbca1c57953a05118eab13d5a7e7ca311d5 Mon Sep 17 00:00:00 2001
From: thampan <joby.thampan@intel.com>
Date: Mon, 2 Jul 2018 23:33:17 +0800
Subject: [PATCH] Checkpatch Warning cleanup

---
 .../ethernet/lantiq/switch-api/mac/gswss_mac_api.c | 13 +++++-------
 .../net/ethernet/lantiq/switch-api/mac/lmac_api.c  | 16 ++-------------
 .../net/ethernet/lantiq/switch-api/mac/mac_cfg.c   |  5 ++---
 .../net/ethernet/lantiq/switch-api/mac/mac_drv.c   |  2 --
 .../ethernet/lantiq/switch-api/mac/mac_tx_fifo.c   | 11 ++---------
 .../ethernet/lantiq/switch-api/mac/mac_tx_fifo.h   | 23 +++++++++++++++++++---
 .../ethernet/lantiq/switch-api/mac/xgmac_debug.c   |  3 +--
 .../ethernet/lantiq/switch-api/mac/xgmac_mac_api.c |  6 +-----
 .../ethernet/lantiq/switch-api/mac/xgmac_main.c    |  3 +--
 .../net/ethernet/lantiq/switch-api/mac/xgmac_ptp.c |  1 -
 10 files changed, 34 insertions(+), 49 deletions(-)

diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/gswss_mac_api.c b/drivers/net/ethernet/lantiq/switch-api/mac/gswss_mac_api.c
index 7939915e55f0..cc0e97199639 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/gswss_mac_api.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/gswss_mac_api.c
@@ -153,7 +153,7 @@ void gswss_help(void)
 
 			if (!strcmp(gswss_mac_cfg[i].cmdname,
 				    "txtstamp_fifo")) {
-				mac_printf("gsw gswss get %11s \t "
+				mac_printf("gsw gswss get %11s \t"
 					   "<0/1/2: MacIdx> <rec_id>\n",
 					   gswss_mac_cfg[i].cmdname);
 				continue;
@@ -169,7 +169,7 @@ void gswss_help(void)
 
 			if (!strcmp(gswss_mac_cfg[i].cmdname,
 				    "txtstamp_fifo")) {
-				mac_printf("switch_cli gswss get %11s \t "
+				mac_printf("switch_cli gswss get %11s \t"
 					   "<0/1/2: MacIdx> <rec_id>\n",
 					   gswss_mac_cfg[i].cmdname);
 				continue;
@@ -179,7 +179,7 @@ void gswss_help(void)
 			    (!strcmp(gswss_mac_cfg[i].cmdname, "r")))
 				continue;
 
-			mac_printf("switch_cli gswss get %11s \t "
+			mac_printf("switch_cli gswss get %11s \t"
 				   "<0/1/2: MacIdx> \n",
 				   gswss_mac_cfg[i].cmdname);
 #endif
@@ -217,8 +217,6 @@ void gswss_help(void)
 #endif
 		}
 	}
-
-	return;
 }
 
 int gswss_mac_check_args(int argc, char *argv)
@@ -233,7 +231,7 @@ int gswss_mac_check_args(int argc, char *argv)
 				mac_printf("switch_cli gswss %s %s\n",
 					   gswss_mac_cfg[i].cmdname,
 					   gswss_mac_cfg[i].help);
-				mac_printf("switch_cli gswss get %s "
+				mac_printf("switch_cli gswss get %s"
 					   "<0/1/2: MacIdx> \n",
 					   gswss_mac_cfg[i].cmdname);
 				return -1;
@@ -1267,7 +1265,6 @@ void gswss_get_txtstamp_fifo(void *pdev,
 
 	f_entry->rec_id = record_id;
 
-
 	mac_dbg("\tTTSE: \t%s\n",
 		f_entry->ttse ? "ENABLED" : "DISABLED");
 	mac_dbg("\tOSTC: \t%s\n",
@@ -1840,6 +1837,6 @@ void gswss_check_reg(void *pdev, u32 reg, char *name, int idx,
 #if defined(PC_UTILITY) || defined(CHIPTEST)
 struct adap_ops *gsw_get_adap_ops(u32 devid)
 {
-	return &(adap_priv_data.ops);
+	return &adap_priv_data.ops;
 }
 #endif
diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/lmac_api.c b/drivers/net/ethernet/lantiq/switch-api/mac/lmac_api.c
index cc3a5190a9b1..3d605104ea39 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/lmac_api.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/lmac_api.c
@@ -50,7 +50,6 @@ void lmac_help(void)
 
 	for (i = 0; i < num_of_elem; i++) {
 		if (lmac_cfg[i].help) {
-
 #if defined(CHIPTEST) && CHIPTEST
 			mac_printf("gsw %s\n",
 				   lmac_cfg[i].help);
@@ -69,7 +68,6 @@ int lmac_check_args(int argc, char *argv)
 
 	for (i = 0; i < num_of_elem; i++) {
 		if (!strcmp(argv, lmac_cfg[i].cmdname)) {
-
 			if (argc != (lmac_cfg[i].args + 4)) {
 				mac_printf("\n--WRONG Command--\n");
 				mac_printf("switch_cli %s\n",
@@ -112,11 +110,9 @@ int lmac_main(u32 argc, u8 *argv[])
 	struct mac_ops *ops;
 	u32 reg_off, reg_val;
 
-
 	start_arg++;
 	start_arg++;
 
-
 	if (argc <= 2) {
 		lmac_help();
 		goto end;
@@ -124,7 +120,6 @@ int lmac_main(u32 argc, u8 *argv[])
 
 	if (!strcmp(argv[start_arg], "-help")) {
 		lmac_help();
-
 		goto end;
 	}
 
@@ -140,9 +135,8 @@ int lmac_main(u32 argc, u8 *argv[])
 	ops = gsw_get_mac_ops(0, idx);
 
 	if (!strcmp(argv[start_arg], "r")) {
-		if (0 != lmac_check_args(argc, (char *)argv[start_arg])) {
+		if (0 != lmac_check_args(argc, (char *)argv[start_arg]))
 			return -1;
-		}
 
 		start_arg++;
 #if defined(PC_UTILITY) || defined(__KERNEL__)
@@ -164,9 +158,8 @@ int lmac_main(u32 argc, u8 *argv[])
 	}
 
 	if (!strcmp(argv[start_arg], "w")) {
-		if (0 != lmac_check_args(argc, (char *)argv[start_arg])) {
+		if (0 != lmac_check_args(argc, (char *)argv[start_arg]))
 			return -1;
-		}
 
 		start_arg++;
 
@@ -198,7 +191,6 @@ int lmac_main(u32 argc, u8 *argv[])
 			lmac_get_rmon();
 			goto end;
 		} else if (!strcmp(argv[start_arg], "all")) {
-
 			lmac_get_intf_mode(ops);
 			lmac_get_duplex_mode(ops);
 			lmac_get_txfcs(ops);
@@ -506,10 +498,6 @@ int lmac_get_int(void *pdev)
 	mac_idx = pdata->mac_idx + LMAC_ISR_MAC2_POS;
 	val = GET_N_BITS(lmac_isr, mac_idx, LMAC_ISR_MAC2_WIDTH);
 
-#if 0
-	mac_printf("LMAC %d Interrupt Stats : %s\n", pdata->mac_idx,
-		   val ? "ENABLED" : "DISABLED");
-#endif
 	return val;
 }
 
diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/mac_cfg.c b/drivers/net/ethernet/lantiq/switch-api/mac/mac_cfg.c
index 22dc9ffef7de..608a932bec0f 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/mac_cfg.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/mac_cfg.c
@@ -922,8 +922,8 @@ int mac_init(void *pdev)
 	mac_set_flowctrl(pdev, 3);
 #endif
 	/* Configure MII for 100M, 10M, 1G and 2.5G to XGMAC by default
-         * default value is LMAC
-         */
+     * default value is LMAC
+     */
 	mac_set_mii_if(pdev, GSW_PORT_HW_GMII);
 
 	if (pdata->haps) {
@@ -1272,4 +1272,3 @@ void mac_init_fn_ptrs(struct mac_ops *mac_op)
 	mac_op->IRQ_Register = mac_irq_register;
 	mac_op->IRQ_UnRegister = mac_irq_unregister;
 }
-
diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/mac_drv.c b/drivers/net/ethernet/lantiq/switch-api/mac/mac_drv.c
index 9004b3361518..03853d22b743 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/mac_drv.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/mac_drv.c
@@ -39,7 +39,6 @@ static irqreturn_t mac_isr(int irq, void *dev_id)
 
 		/* Check XGMAC i Interrupts */
 		if (mac_int_sts & (1 << (GSWIPSS_IER0_XGMAC2_POS + i))) {
-
 			/* Disable the XGMAC 2/3/4 Interrupt First */
 			gswss_set_interrupt(adap_ops, XGMAC,
 					    pdata->mac_idx, 0);
@@ -62,7 +61,6 @@ static irqreturn_t mac_isr(int irq, void *dev_id)
 			tasklet_schedule(&pdata->mac_tasklet);
 	}
 
-
 	return IRQ_HANDLED;
 }
 
diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/mac_tx_fifo.c b/drivers/net/ethernet/lantiq/switch-api/mac/mac_tx_fifo.c
index 065d85aeb260..05676fde2087 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/mac_tx_fifo.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/mac_tx_fifo.c
@@ -96,8 +96,6 @@ void fifo_entry_del(void *pdev, u32 rec_id)
 
 	/* Fifo available for the next packet */
 	f_entry->is_used = 0;
-
-	return;
 }
 
 static void fifo_update_hw_clrsts(void *pdev,
@@ -129,11 +127,8 @@ void fifo_isr_handler(void *pdev)
 		if (pdata->ts_fifo[i].is_used)
 			fifo_update_hw_clrsts(pdev, &pdata->ts_fifo[i]);
 	}
-
-	return;
 }
 
-
 u32 timer_in_sec(u32 jiffies)
 {
 #ifdef __KERNEL__
@@ -175,8 +170,6 @@ void print_fifo(void *pdev)
 			   pdata->ts_fifo[i].jiffies);
 #endif
 	}
-
-	return;
 }
 
 static int fifo_freeid_get(void *pdev, u8 ttse)
@@ -194,9 +187,9 @@ static int fifo_freeid_get(void *pdev, u8 ttse)
 			}
 
 			/* If nothing stored in Xgmac Fifo */
-			if (mac_fifo_cnt == 0)
+			if (mac_fifo_cnt == 0) {
 				return pdata->ts_fifo[i].rec_id;
-			else {
+			} else {
 				mac_printf("Xgmac Fifo already have entry\n");
 				return FIFO_FULL;
 			}
diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/mac_tx_fifo.h b/drivers/net/ethernet/lantiq/switch-api/mac/mac_tx_fifo.h
old mode 100644
new mode 100755
index 6c2f47bd0e4b..1e1cdc94fc93
--- a/drivers/net/ethernet/lantiq/switch-api/mac/mac_tx_fifo.h
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/mac_tx_fifo.h
@@ -10,9 +10,9 @@
 #ifndef _MAC_TXFIFO_H
 #define _MAC_TXFIFO_H
 
-#define FIFO_TIMEOUT_IN_SEC         	100     /*  5 minute */
-#define MAX_FIFO_ENTRY			64
-#define START_FIFO			1
+#define FIFO_TIMEOUT_IN_SEC         	100     /* 100 Sec */
+#define MAX_FIFO_ENTRY			64	/* Max Hw Fifo available */
+#define START_FIFO			1	/* */
 
 enum {
 	FIFO_FULL = -1,
@@ -20,15 +20,32 @@ enum {
 	FIFO_ENTRY_NOT_AVAIL = -3,
 };
 
+/* GSWIP Tx Fifo to send signal from GSWIP to Xgmac
+ * to do the action on the packet
+ * Actions include
+ * 1) Store Tx Timestamp
+ * 2) One Step TImestamp update for Sync packets
+ * 3) Packet ID update for the stored timestamp
+ * 4) Timestamp correction needed
+ * Entry will be cleared by the HW when packet is sent out
+ */
 struct mac_fifo_entry {
 	u32 is_used;
+	/* RecordID, denotes index to the 64 entry Fifo */
 	u32 rec_id;
+	/* Transmit Timestamp Store Enable */
 	u8 ttse;
+	/* One Step Timestamp Capture Enable */
 	u8 ostc;
+	/* One Step Timestamp Available/PacketID Available */
 	u8 ostpa;
+	/* Checksum Insertion or Update information */
 	u8 cic;
+	/* Lower 32 byte of time correction */
 	u32 ttsl;
+	/* Upper 32 byte of time correction */
 	u32 ttsh;
+	/* Timeout for this Fifo Entry */
 	u32 timeout;
 	u32 jiffies;
 #ifdef __KERNEL__
diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_debug.c b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_debug.c
index 593fb9cbe6ad..661d8181be1c 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_debug.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_debug.c
@@ -1884,7 +1884,6 @@ int xgmac_get_stats(void *pdev)
 }
 #endif
 
-
 int xgmac_get_priv_data(void *pdev)
 {
 	struct mac_prv_data *pdata = GET_MAC_PDATA(pdev);
@@ -2027,7 +2026,7 @@ int xgmac_print_hw_cap(void *pdev)
 			   "for the Descriptor Cache.\n");
 
 	if (hw_feat->edma)
-		mac_printf("\t “Enhanced DMA” option is selected.\n");
+		mac_printf("\t Enhanced DMA option is selected.\n");
 
 	mac_printf("========== Hardware feature register 1 ==============\n");
 
diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_mac_api.c b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_mac_api.c
index 6a83bddad35b..3d3748d893c6 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_mac_api.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_mac_api.c
@@ -617,6 +617,7 @@ int xgmac_set_rxcrc(void *pdev, u32 val)
 
 	return 0;
 }
+
 /* RE:
  * When this bit is set, the Rx state machine of the MAC is enabled for
  * receiving packets from the GMII or XGMII interface
@@ -966,12 +967,10 @@ int xgmac_lpi_int_clr(void *pdev)
 	return ret;
 }
 
-
 /* RWKPKTEN: Remote Wake-Up Packet Enable
  * if 1, a power management event is generated when
  * the MAC receives a remote wake-up packet.
  */
-
 int xgmac_set_rwk_pmt(void *pdev, u32 val)
 {
 	struct mac_prv_data *pdata = GET_MAC_PDATA(pdev);
@@ -1162,7 +1161,6 @@ int xgmac_set_tstamp_addend(void *pdev, u32 tstamp_addend)
  * This bit should be zero before it is updated.
  * This bit is reset when the initialization is complete.
  */
-
 int xgmac_init_systime(void *pdev, u32 sec, u32 nsec)
 {
 	struct mac_prv_data *pdata = GET_MAC_PDATA(pdev);
@@ -1307,7 +1305,6 @@ int xgmac_get_txtstamp_pktid(void *pdev)
 	return pktid;
 }
 
-
 /* TSCTRLSSR:Timestamp Digital or Binary Rollover Control
  * if 1, the Timestamp Low register rolls over after 0x3B9A_C9FF value
  * (that is, 1 nanosecond accuracy) and increments
@@ -1593,7 +1590,6 @@ int xgmac_set_hwtstamp_settings(void *pdev,
 	}
 
 	if (ptp_flgs.ptp_rx_en != 0) {
-
 		/* In FalconMx all packets have timestamp */
 		ptp_flgs.ptp_rx_en |= PTP_RX_EN_ALL;
 
diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_main.c b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_main.c
index 81e450d05440..8d0bf93c5c9d 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_main.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_main.c
@@ -908,7 +908,6 @@ int xgmac_main(u32 argc, u8 *argv[])
 				return 0;
 			}
 
-
 			set_data(argv, i, &start_arg, idx);
 
 			if (xgmac_cfg_table[i].set_func)
@@ -1036,7 +1035,7 @@ void xgmac_cli_init(void)
 #if defined(PC_UTILITY) || defined(CHIPTEST)
 struct mac_ops *gsw_get_mac_ops(u32 devid, u32 mac_idx)
 {
-	return &(prv_data[mac_idx].ops);
+	return &prv_data[mac_idx].ops;
 }
 
 u32 gsw_get_mac_subifcnt(u32 devid)
diff --git a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_ptp.c b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_ptp.c
index 5b902959365b..a941e9157d6e 100644
--- a/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_ptp.c
+++ b/drivers/net/ethernet/lantiq/switch-api/mac/xgmac_ptp.c
@@ -344,7 +344,6 @@ int xgmac_tx_hwts(void *pdev, struct sk_buff *skb)
 	u16 ethtype;
 	u8 *ptp_loc = NULL;
 	u8 msg_type = PTP_MSGTYPE_INVALID;
-	struct skb_shared_hwtstamps shhwtstamp = {0};
 
 	/* check for hw tstamping */
 	if (pdata->hw_feat.ts_src && pdata->ptp_flgs.ptp_tx_en &&
